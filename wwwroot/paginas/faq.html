<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Preguntas Frecuentes - Clasificador Inteligente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
    /* NAVBAR FIJA Y MODERNA */
.navbar {
  position: fixed;            /* Se mantiene fija en la parte superior */
  top: 0;
  width: 100%;
  background-color: #002147;  /* Azul institucional */
  color: white;
  display: flex;
  justify-content: space-between; /* Logo a la izquierda, enlaces a la derecha */
  align-items: center;
  padding: 12px 24px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2); /* Sombra sutil */
  z-index: 1030;
  font-family: 'Segoe UI', sans-serif;
}

.navbar .logo {
  display: flex;
  align-items: center;
  gap: 10px;
}

.navbar .logo svg {
  width: 28px;
  height: 28px;
}

.navbar .nav-links {
  display: flex;
  gap: 20px;
}

.navbar a {
  color: white;
  text-decoration: none;
  font-weight: 600;
  transition: color 0.3s ease;
}

.navbar a:hover {
  color: #00c3ff;
}

/* Para pantallas pequeñas */
@media (max-width: 600px) {
  .navbar {
    flex-direction: column;
    align-items: flex-start;
  }

  .navbar .nav-links {
    flex-direction: column;
    gap: 10px;
    padding-top: 10px;
  }
}

/* Ajuste general para que el contenido no quede oculto detrás de la navbar */
body {
  padding-top: 70px; /* Altura aproximada de la navbar */
}

</style>
</head>
<!-- NAVBAR superior -->

  <nav class="navbar">
  <div class="logo">
    <!-- Ícono cambiado -->
    <i class="bi-search"></i>
    <span>FICCT RESPONDE</span>
  </div>

  <div class="nav-links">
  <button id="btnCerrarSesion" class="btn btn-outline-light btn-sm">
    <i class="bi bi-box-arrow-right"></i> Cerrar sesión
  </button>
</div>

</nav>

<body class="bg-light">

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-7 col-lg-5 bg-white rounded shadow p-4">
                <div id="welcomeMessage" class="alert alert-info text-center d-none" role="alert">
                    </div>

                <h2 class="mb-4 text-center text-primary fw-bold">¿Tienes una duda?</h2>
                <p class="text-center text-muted mb-4">Escribe tu pregunta y nuestro sistema te ayudará a encontrar la respuesta correcta.</p>

                <div class="mb-3">
                    <input 
                        type="text" 
                        id="preguntaInput" 
                        class="form-control form-control-lg" 
                        placeholder="Ej. inscribir materias" 
                        aria-label="Pregunta frecuente" 
                    />
                </div>
                <div class="d-grid mb-3">
                    <button 
                        class="btn btn-primary btn-lg" 
                        onclick="enviarPregunta()"
                        id="btnEnviar"
                    >
                        Enviar
                    </button>
                </div>
               

                <div id="respuestaFaq" role="alert" aria-live="polite"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>
    document.addEventListener('DOMContentLoaded', () => {
        const welcomeMessageElem = document.getElementById('welcomeMessage');
        const loginExitoso = localStorage.getItem('loginExitoso');

        if (loginExitoso === 'true') {
            welcomeMessageElem.classList.remove('d-none');
            welcomeMessageElem.innerText = '¡Bienvenido!';
            localStorage.removeItem('loginExitoso');
        }

        // Detectar Enter en el input
        document.getElementById('preguntaInput').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                enviarPregunta();
            }
        });

        // Evento para cerrar sesión
        document.getElementById('btnCerrarSesion').addEventListener('click', () => {
            localStorage.clear();
            window.location.href = 'login.html'; // Cambia si tu login está en otra ruta
        });
    });


        // Tu función existente para enviar preguntas
        async function enviarPregunta() {
            console.log("Botón presionado");
            const pregunta = document.getElementById("preguntaInput").value.trim();
            const respuestaElem = document.getElementById("respuestaFaq");
            const btnEnviar = document.getElementById("btnEnviar");

            respuestaElem.className = ''; // reset clases
            respuestaElem.innerHTML = '';

            if (!pregunta) {
                respuestaElem.className = 'alert alert-warning';
                respuestaElem.innerText = "Por favor, escribe una pregunta.";
                return;
            }

            try {
                btnEnviar.disabled = true;
                btnEnviar.innerText = "Enviando...";
                const BASE_URL = "https://clasificador-inteligente.onrender.com";

                const response = await fetch(`${BASE_URL}/api/faq/responder`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ pregunta })
                });

                if (!response.ok) {
                    throw new Error(`Error en la solicitud: ${response.status}`);
                }

                const texto = await response.text();

                respuestaElem.className = 'alert alert-success';
                respuestaElem.innerText = texto;
            } catch (error) {
                respuestaElem.className = 'alert alert-danger';
                respuestaElem.innerText = "Ocurrió un error al enviar la pregunta.";
                console.error(error);
            } finally {
                btnEnviar.disabled = false;
                btnEnviar.innerText = "Enviar";
            }
        }
    </script>

</body>
</html>
